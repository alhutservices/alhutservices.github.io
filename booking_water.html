<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ù„Ø¨ ØªÙ†ÙƒØ± Ù…Ø§Ø¡ | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #F0F9FF; }
        /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ù‡ÙŠØ¯Ø± Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ù…Ø§Ø¦ÙŠ */
        .hero-section { background: linear-gradient(180deg, #0EA5E9 0%, #0284C7 100%); border-radius: 0 0 3rem 3rem; }
        
        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ¨Ø³ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© */
        .input-card {
            background: white;
            border: 2px solid #FFD700; /* Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„Ù…Ù…ÙŠØ² */
            border-radius: 1.5rem;
            padding: 1rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            transition: 0.3s;
        }
        .input-label { color: #64748b; font-size: 0.8rem; font-weight: 800; margin-bottom: 5px; display: block; }
        .input-field { width: 100%; border: none; outline: none; font-weight: 900; color: #075985; font-size: 1rem; background: transparent; }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
        .map-container { background: #E0F2FE; border-radius: 2.5rem; padding: 1.5rem; margin-top: 1.5rem; }
        .map-box { height: 250px; border-radius: 1.5rem; border: 3px solid white; margin-bottom: 10px; z-index: 1; }
        
        .btn-location { background: #0EA5E9; color: white; padding: 10px 20px; border-radius: 1rem; font-weight: 800; font-size: 0.8rem; width: 100%; }
        .btn-main { background: #0EA5E9; color: white; padding: 1.2rem; border-radius: 1.5rem; font-weight: 900; font-size: 1.2rem; width: 100%; box-shadow: 0 10px 20px rgba(14, 165, 233, 0.3); }
    </style>
</head>
<body>

    <header class="hero-section text-white pt-10 pb-20 text-center relative">
        <div class="text-5xl mb-3">ğŸ’§</div>
        <h1 class="text-3xl font-black italic">ØªØ£ÙƒÙŠØ¯ Ø­ÙˆØ¶ÙŠØ© Ø§Ù„Ù…Ø§Ø¡</h1>
        <p id="cityDisplay" class="opacity-80 text-sm mt-2">Ù†Ø­Ù† Ù†ØµÙ„ Ø¥Ù„ÙŠÙƒ Ø£ÙŠÙ†Ù…Ø§ ÙƒÙ†Øª</p>
    </header>

    <main class="container mx-auto px-6 -mt-12 pb-20">
        <div class="grid grid-cols-2 gap-4 mb-8">
            <div class="input-card">
                <label class="input-label">ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¯Ø±Ø¨ (Ø§Ù„Ø²Ø¨ÙˆÙ†)</label>
                <input type="text" id="custName" placeholder="Ø£ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ.." class="input-field">
            </div>
            <div class="input-card">
                <label class="input-label">ğŸ“ Ø±Ù‚Ù… (ÙˆØ§ØªØ³Ø§Ø¨)</label>
                <input type="tel" id="custPhone" placeholder="077..." class="input-field text-left" dir="ltr">
            </div>
        </div>

        <div class="input-card mb-8" style="border-color: #BAE6FD;">
            <label class="input-label">ğŸ  Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹</label>
            <input type="text" id="locDetails" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù‚Ø±Ø¨ Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø­ÙƒÙ…Ø©.." class="input-field">
        </div>

        <div class="map-container">
            <h3 class="font-black text-sky-900 mb-4 flex items-center gap-2">
                <i class="fas fa-map-marker-alt text-red-500"></i> ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù„Ù‚Ø§Ø¡ (Ø§Ù„ØªÙØ±ÙŠØº):
            </h3>
            <div id="map" class="map-box"></div>
            <button onclick="getLocation()" class="btn-location flex items-center justify-center gap-2">
                 ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ <i class="fas fa-location-arrow"></i>
            </button>
        </div>

        <div class="mt-10">
            <button onclick="confirmWaterOrder()" class="btn-main flex items-center justify-center gap-3">
                Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª <i class="fas fa-chevron-left"></i>
            </button>
        </div>
    </main>

    <script>
        let map, marker;
        const u = new URLSearchParams(window.location.search);

        window.onload = function() {
            const city = u.get('city') || "ÙƒØ±ÙƒÙˆÙƒ";
            document.getElementById('cityDisplay').innerText = `Ø®Ø¯Ù…Ø© Ø§Ù„Ø­ÙˆØª ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© ${city} ğŸ“`;

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©
            map = L.map('map', {zoomControl: false}).setView([35.4687, 44.3921], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            marker = L.marker([35.4687, 44.3921], {draggable: true}).addTo(map);
        };

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(pos => {
                    const c = [pos.coords.latitude, pos.coords.longitude];
                    map.setView(c, 16); marker.setLatLng(c);
                });
            }
        }

        function confirmWaterOrder() {
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            const desc = document.getElementById('locDetails').value;
            const pos = marker.getLatLng();

            if(!name || !phone) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ğŸ‹ğŸ’§");

            u.set('name', name);
            u.set('phone', phone);
            u.set('sDesc', desc);
            u.set('lat', pos.lat);
            u.set('lng', pos.lng);
            u.set('vehicle', 'ØªÙ†ÙƒØ± Ù…Ø§Ø¡ (Ø­ÙˆØ¶ÙŠ)');
            u.set('emoji', 'ğŸ’§');

            window.location.href = `review.html?${u.toString()}`;
        }
    </script>
</body>
</html>
