<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ | Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø­ÙˆØª ğŸ‹âœ¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --main-theme: #002349; --accent-theme: #D4AF37; }
        body { font-family: 'Tajawal', sans-serif; background: #f0f4f8; overflow: hidden; }
        
        .main-card {
            background: white;
            border-radius: 3.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 35, 73, 0.2);
            position: relative;
            z-index: 10;
        }

        .bounce-in { animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3) translateY(100px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .success-glow {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 300px; height: 300px; background: var(--main-theme);
            filter: blur(100px); opacity: 0.1; z-index: -1;
        }

        .lang-badge { font-size: 0.7rem; font-weight: 800; color: #94a3b8; background: #f8fafc; padding: 6px 12px; border-radius: 1rem; border: 1px solid #f1f5f9; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="success-glow"></div>
    
    <div id="mainBox" class="max-w-md w-full main-card p-8 text-center bounce-in border-t-[12px]" style="border-color: var(--main-theme);">
        
        <div class="flex justify-center mb-2">
            <dotlottie-player src="https://lottie.host/82823631-f923-4412-bd77-2e9154784411/6vR0FvI7oN.json" background="transparent" speed="1.2" style="width: 160px; height: 160px;" loop autoplay></dotlottie-player>
        </div>

        <h1 id="mainGreeting" class="text-3xl font-black mb-1" style="color: var(--main-theme);">Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„Ø¥ØªÙ…Ø§Ù…!</h1>
        <h2 id="userNameDisplay" class="text-xl font-black mb-4" style="color: var(--accent-theme);">...</h2>

        <div class="bg-blue-50/50 p-4 rounded-3xl mb-6">
            <p id="cityBlessing" class="text-blue-900 font-black text-sm leading-relaxed italic">
                Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„ØªØ­ÙŠØ©...
            </p>
        </div>

        <p class="text-slate-500 font-bold text-xs px-4 leading-relaxed mb-6">
            ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø³ÙŠÙ‚ÙˆÙ… <span class="font-black text-blue-600">Ø£Ù‚Ø±Ø¨ Ù…ÙƒØªØ¨ Ø­ÙˆØª</span> Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‡Ø§ØªÙÙŠØ§Ù‹ Ù„Ø¥ØªÙ…Ø§Ù… Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ….
        </p>

        <div class="bg-slate-50 p-6 rounded-[2.5rem] mb-8 border-2 border-dashed border-slate-200 relative">
            <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠ</p>
            <p id="orderIDDisplay" class="text-2xl font-black tracking-tighter" style="color: var(--main-theme);">#HUT-0000</p>
            <div id="summaryText" class="text-[10px] font-bold text-green-600 mt-2 flex items-center justify-center gap-1">
                <i class="fas fa-satellite-dish animate-pulse"></i> ØªÙ… Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±
            </div>
        </div>

        <a href="index.html" class="block w-full py-5 rounded-2xl font-black text-xl shadow-xl transition-all active:scale-95 text-white" style="background: var(--main-theme);">
            Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </a>

        <div class="flex justify-center gap-2 mt-6 overflow-hidden">
            <span class="lang-badge">SUCCESS!</span>
            <span class="lang-badge">Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆ Ø¨ÙˆÙˆ!</span>
            <span class="lang-badge">BAÅARILI!</span>
        </div>
    </div>

    <script>
        const u = new URLSearchParams(window.location.search);
        const scriptURL = "https://script.google.com/macros/s/AKfycbznxCVbF350cer5qcXlIROrNmmnf5993r9-AoLbNKqb8YfVNhhT3rREefD7dbK6RFIH/exec";

        const cityBlessings = {
            "Ø¨ØºØ¯Ø§Ø¯": "ÙŠØ±Ø¹Ø§Ùƒ Ø§Ù„Ù„Ù‡ ÙÙŠ Ø£Ø±Ø¶ Ù‡Ø§Ø±ÙˆÙ† Ø§Ù„Ø±Ø´ÙŠØ¯ Ø¨ØºØ¯Ø§Ø¯ ğŸ°",
            "ÙƒØ±ÙƒÙˆÙƒ": "Ø­ÙŠØ§Ùƒ Ø§Ù„Ù„Ù‡ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù‚Ù„Ø§Ø¹ ÙˆØ§Ù„Ø¥Ø®Ø§Ø¡ ÙƒØ±ÙƒÙˆÙƒ ğŸ’",
            "Ø£Ø±Ø¨ÙŠÙ„": "Ù†ÙˆØ±ØªÙ†Ø§ ÙÙŠ Ø­Ø¶Ù† Ø§Ù„Ù‚Ù„Ø¹Ø© Ø§Ù„Ø´Ø§Ù…Ø®Ø© Ø£Ø±Ø¨ÙŠÙ„ ğŸ”ï¸",
            "Ø§Ù„Ø¨ØµØ±Ø©": "Ø¹Ù„Ù‰ Ø±Ø§Ø³ÙŠ Ø£Ù‡Ù„Ù†Ø§ ÙÙŠ Ø«ØºØ± Ø§Ù„Ø¹Ø±Ø§Ù‚ Ø§Ù„Ø¨Ø§Ø³Ù… Ø§Ù„Ø¨ØµØ±Ø© ğŸŒŠ",
            "Ø§Ù„Ù…ÙˆØµÙ„": "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø­Ø¯Ø¨Ø§Ø¡ Ø£Ù… Ø§Ù„Ø±Ø¨Ø¹ÙŠÙ† Ø§Ù„Ù…ÙˆØµÙ„ ğŸ›ï¸",
            "Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©": "Ø­ÙŠØ§ Ø§Ù„Ù„Ù‡ Ø£Ù‡Ù„ Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ù„Ø¬Ù…Ø§Ù„ ÙÙŠ Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ© âœ¨",
            "Ø§Ù„Ù†Ø¬Ù": "Ù†ÙˆØ±ØªÙ†Ø§ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¹Ù„Ù… ÙˆØ§Ù„Ø¹Ù„Ù…Ø§Ø¡ Ø§Ù„Ù†Ø¬Ù Ø§Ù„Ø£Ø´Ø±Ù ğŸ•Œ",
            "ÙƒØ±Ø¨Ù„Ø§Ø¡": "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø­Ø³ÙŠÙ† ÙƒØ±Ø¨Ù„Ø§Ø¡ Ø§Ù„Ù…Ù‚Ø¯Ø³Ø© ğŸ•Šï¸",
            "Ø§Ù„Ø£Ù†Ø¨Ø§Ø±": "Ø­ÙŠ Ø§Ù„Ù„Ù‡ Ø£Ù‡Ù„ Ø§Ù„ÙƒØ±Ù… ÙˆØ§Ù„ØºÙŠØ±Ø© ÙÙŠ Ø§Ù„Ø£Ù†Ø¨Ø§Ø± ğŸŒ´",
            "default": "ÙŠØ±Ø¹Ø§Ùƒ Ø§Ù„Ù„Ù‡ Ø£ÙŠÙ†Ù…Ø§ ÙƒÙ†Øª ÙÙŠ Ø£Ø±Ø¶ Ø§Ù„Ø¹Ø±Ø§Ù‚ Ø§Ù„Ø¹Ø¸ÙŠÙ… ğŸ‡®ğŸ‡¶"
        };

        const translationMap = {
            "Kirkuk": "ÙƒØ±ÙƒÙˆÙƒ", "Baghdad": "Ø¨ØºØ¯Ø§Ø¯", "Erbil": "Ø£Ø±Ø¨ÙŠÙ„", "Basra": "Ø§Ù„Ø¨ØµØ±Ø©",
            "Sulaymaniyah": "Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©", "Duhok": "Ø¯Ù‡ÙˆÙƒ", "Anbar": "Ø§Ù„Ø£Ù†Ø¨Ø§Ø±", "Diyala": "Ø¯ÙŠØ§Ù„Ù‰",
            "Male": "Ø°ÙƒØ±", "Female": "Ø£Ù†Ø«Ù‰",
            "personal": "ØªØ£Ø¬ÙŠØ± Ø´Ø®ØµÙŠ", "wedding": "Ø£Ø¹Ø±Ø§Ø³ ÙˆÙ…Ù†Ø§Ø³Ø¨Ø§Øª", "training": "ØªØ¹Ù„ÙŠÙ… Ù‚ÙŠØ§Ø¯Ø©"
        };

        function trans(text) { return translationMap[text] || text || "---"; }

        window.onload = () => {
            // 1. ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            let orderID = sessionStorage.getItem('currentOrderID') || "HUT-" + Math.floor(1000 + Math.random() * 9000);
            sessionStorage.setItem('currentOrderID', orderID);
            document.getElementById('orderIDDisplay').innerText = "#" + orderID;

            const city = trans(u.get('city') || u.get('province') || u.get('prov'));
            const userName = u.get('name') || "Ø¹Ù…ÙŠÙ„Ù†Ø§ Ø§Ù„Ø¹Ø²ÙŠØ²";
            document.getElementById('userNameDisplay').innerText = userName;

            // 2. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©
            const blessing = cityBlessings[city] || cityBlessings["default"];
            document.getElementById('cityBlessing').innerText = blessing;

            // 3. ØªØ£Ø«ÙŠØ± Ø§Ù„Ø§Ø­ØªÙØ§Ù„ ğŸŠ (confetti)
            const type = u.get('type') || 'personal';
            const colors = type === 'wedding' ? ['#be185d', '#ff0000', '#ffffff'] : ['#002349', '#D4AF37', '#ffffff'];
            
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 },
                colors: colors
            });

            // 4. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø³ÙƒØ±ÙŠØ¨Øª (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)
            if (sessionStorage.getItem('orderSent') !== 'true') {
                const data = {
                    order_id: orderID,
                    name: userName,
                    phone: u.get('phone') || "---",
                    province: city,
                    car: u.get('car') || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯",
                    days: u.get('days') || u.get('date') || "---",
                    addons: u.get('addons') || u.get('addon_name') || "Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø·",
                    total_price: u.get('total_final') || u.get('price') || "0",
                    gender: trans(u.get('gender')),
                    age: u.get('age') || "---",
                    service: trans(u.get('service') || u.get('type')),
                    location_link: u.get('map') || ""
                };

                fetch(scriptURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(data)
                }).then(() => {
                    sessionStorage.setItem('orderSent', 'true');
                });
            }
        };
    </script>
</body>
</html>
