<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; }
        .receipt-line { border-bottom: 2px dashed #e2e8f0; padding: 12px 0; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-xl mx-auto bg-white rounded-[3rem] shadow-2xl overflow-hidden border-b-[12px] border-[#002349]">
        
        <div class="bg-[#002349] p-8 text-center text-white">
            <div class="text-5xl mb-3">ğŸ‹</div>
            <h2 class="text-2xl font-black text-[#D4AF37]">Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø²</h2>
            <p class="opacity-70 text-sm mt-1">ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</p>
        </div>

        <div class="p-8 space-y-2" id="reviewContent">
            </div>

        <div class="p-8 bg-slate-50">
            <button onclick="sendToWhatsApp()" class="w-full bg-[#25D366] text-white py-5 rounded-2xl font-black text-xl shadow-xl flex items-center justify-center gap-3 hover:scale-95 transition-all">
                ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ <i class="fab fa-whatsapp text-2xl"></i>
            </button>
            <p class="text-center text-[10px] text-gray-400 mt-4 font-bold uppercase italic">Ù…Ù†ØµØ© Ø§Ù„Ø­ÙˆØª - Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„Ø¹Ø±Ø§Ù‚</p>
        </div>
    </div>

    <script>
        const p = new URLSearchParams(window.location.search);
        const service = p.get('service');
        const reviewContent = document.getElementById('reviewContent');

        // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø·ÙˆØ± ÙÙŠ Ø§Ù„ÙˆØµÙ„
        function createLine(label, value, icon) {
            if(!value) return '';
            return `
                <div class="receipt-line flex justify-between items-center">
                    <span class="text-gray-400 text-sm font-bold flex items-center gap-2">
                        <i class="fas ${icon} text-[#002349]"></i> ${label}
                    </span>
                    <span class="text-[#002349] font-black">${decodeURIComponent(value)}</span>
                </div>`;
        }

        // Ø¨Ù†Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©
        let html = '';
        
        // 1. Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© (Ù„ÙƒÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª)
        html += createLine('Ø§Ù„Ø®Ø¯Ù…Ø©', p.get('car') || 'Ø®Ø¯Ù…Ø© Ø¹Ø§Ù…Ø©', 'fa-car');
        html += createLine('Ø§Ù„ØªØ§Ø±ÙŠØ®', p.get('date'), 'fa-calendar');
        html += createLine('Ø§Ù„ÙˆÙ‚Øª', p.get('time'), 'fa-clock');

        // 2. Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø®Ø¯Ù…Ø© "ØªØ¯Ø±ÙŠØ¨" Ø§Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
        if (service === 'training') {
            html += `<h3 class="font-black text-[#D4AF37] pt-4 pb-2 border-b-2 border-[#D4AF37] inline-block mb-4">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¯Ø±Ø¨</h3>`;
            html += createLine('Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¯Ø±Ø¨', p.get('name'), 'fa-user');
            html += createLine('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ', p.get('phone'), 'fa-phone');
            html += createLine('Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ©', p.get('nationalID'), 'fa-id-card');
            html += createLine('Ø§Ù„Ø¬Ù†Ø³', p.get('gender'), 'fa-venus-mars');
            html += createLine('Ø§Ù„Ø¹Ù…Ø±', p.get('age'), 'fa-birthday-cake');
            
            // Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ (Ø§Ù„Ù…Ù†Ø·Ù‚Ø©)
            const mapLink = `https://www.google.com/maps?q=${p.get('lat')},${p.get('lng')}`;
            html += `
                <div class="receipt-line flex justify-between items-center">
                    <span class="text-gray-400 text-sm font-bold flex items-center gap-2">
                        <i class="fas fa-map-marker-alt text-[#002349]"></i> Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ù‚Ø§Ø¡
                    </span>
                    <a href="${mapLink}" target="_blank" class="text-blue-600 font-black underline text-sm">ÙØªØ­ Ø§Ù„Ø®Ø±ÙŠØ·Ø© ğŸ“</a>
                </div>`;
        } else {
            // Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø¬Ø² Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠ
            html += createLine('Ø§Ù„Ø§Ø³Ù…', p.get('name'), 'fa-user');
            html += createLine('Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª', p.get('addons'), 'fa-plus-circle');
            html += `<div class="receipt-line flex justify-between items-center bg-yellow-50 p-4 rounded-xl mt-4">
                        <span class="font-black text-[#002349]">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ</span>
                        <span class="text-2xl font-black text-[#002349]">${p.get('total') || 'Ø­Ø³Ø¨ Ø§Ù„Ø§ØªÙØ§Ù‚'} Ø¯.Ø¹</span>
                    </div>`;
        }

        reviewContent.innerHTML = html;

        function sendToWhatsApp() {
            let message = `ğŸ‹ *Ø·Ù„Ø¨ Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…Ù†ØµØ© Ø§Ù„Ø­ÙˆØª* \n\n`;
            message += `ğŸ—‚ *Ø§Ù„Ø®Ø¯Ù…Ø©:* ${p.get('car')} \n`;
            message += `ğŸ“… *Ø§Ù„ØªØ§Ø±ÙŠØ®:* ${p.get('date')} \n`;
            message += `â° *Ø§Ù„ÙˆÙ‚Øª:* ${p.get('time')} \n`;

            if (service === 'training') {
                message += `\nğŸ‘¤ *Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¯Ø±Ø¨:* \n`;
                message += `â€¢ Ø§Ù„Ø§Ø³Ù…: ${p.get('name')} \n`;
                message += `â€¢ Ø§Ù„Ù‡Ø§ØªÙ: ${p.get('phone')} \n`;
                message += `â€¢ Ø§Ù„Ù‡ÙˆÙŠØ©: ${p.get('nationalID')} \n`;
                message += `â€¢ Ø§Ù„Ø¬Ù†Ø³: ${p.get('gender')} \n`;
                message += `â€¢ Ø§Ù„Ø¹Ù…Ø±: ${p.get('age')} \n`;
                message += `ğŸ“ *Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù„Ù‚Ø§Ø¡:* https://www.google.com/maps?q=${p.get('lat')},${p.get('lng')} \n`;
            } else {
                message += `ğŸ‘¤ *Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${p.get('name')} \n`;
                message += `â• *Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª:* ${p.get('addons') || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'} \n`;
                message += `ğŸ’° *Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ:* ${p.get('total')} Ø¯.Ø¹ \n`;
            }

            message += `\nğŸ‹ ØªÙ… Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ù…Ù†ØµØ© Ø§Ù„Ø­ÙˆØª Ø§Ù„Ø°ÙƒÙŠØ©.`;

            const whatsappUrl = `https://wa.me/9647713225471?text=${encodeURIComponent(message)}`;
            window.location.href = whatsappUrl;
        }
    </script>
</body>
</html>
