<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ®ØµÙŠØµ Ø§Ù„ØªØ¬Ø±Ø¨Ø© | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --brand: #002349; --gold: #D4AF37; }
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; transition: 0.8s cubic-bezier(0.4, 0, 0.2, 1); overflow-x: hidden; }
        
        /* ØªØ£Ø«ÙŠØ± Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© Ø§Ù„Ø°ÙƒÙŠØ© */
        .smart-card { 
            background: white; border-radius: 2.2rem; border: 2px solid transparent;
            transition: 0.4s; cursor: pointer; position: relative;
        }
        .smart-card.selected { 
            border-color: var(--gold); transform: scale(1.02);
            box-shadow: 0 15px 35px rgba(212, 175, 55, 0.15);
        }

        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª */
        .icon-circle { 
            width: 55px; height: 55px; border-radius: 1.2rem; 
            display: flex; items-center; justify-center; font-size: 1.5rem;
            transition: 0.5s; background: #f1f5f9;
        }
        .smart-card.selected .icon-circle { background: var(--gold); color: white; transform: rotate(360deg); }

        /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
        .glass-footer { 
            position: fixed; bottom: 0; left: 0; right: 0; 
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px);
            padding: 1.5rem; border-top: 1px solid rgba(0,0,0,0.05); z-index: 1000;
        }

        .mood-tag { font-size: 0.6rem; font-weight: 900; padding: 4px 12px; border-radius: 20px; text-transform: uppercase; }
    </style>
</head>
<body class="pb-40">

    <header id="headerSection" class="text-center py-12 px-6 transition-all duration-700">
        <div id="heroEmoji" class="text-7xl mb-4 animate-bounce">ğŸ‹</div>
        <div id="moodBadge" class="mood-tag bg-slate-200 text-slate-500 inline-block mb-3">Ø®Ø¯Ù…Ø© Ø¹Ø§Ù…Ø©</div>
        <h1 id="heroTitle" class="text-3xl font-black text-[#002349]">Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„Ø­ÙˆØª</h1>
        <p id="heroDesc" class="text-gray-400 font-bold text-xs mt-2 uppercase tracking-tighter">Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø§Ø³Ø¨ Ø±Ø­Ù„ØªÙƒ Ø§Ù„ÙŠÙˆÙ…</p>
    </header>

    <main class="max-w-md mx-auto px-5 space-y-4" id="addonsList">
        </main>

    <div class="glass-footer">
        <div class="max-w-md mx-auto flex items-center justify-between">
            <div>
                <span class="text-[10px] font-black text-gray-400 block uppercase">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ</span>
                <div class="flex items-baseline gap-1 text-[#002349]">
                    <span id="totalDisplay" class="text-3xl font-black">0</span>
                    <span class="text-xs font-bold opacity-50">Ø¯.Ø¹</span>
                </div>
            </div>
            <button onclick="confirmChoices()" class="bg-[#002349] text-white px-10 py-4 rounded-2xl font-black flex items-center gap-3 active:scale-90 transition-all shadow-xl">
                Ù…ØªØ§Ø¨Ø¹Ø© <i class="fas fa-chevron-left text-xs text-[#D4AF37]"></i>
            </button>
        </div>
    </div>

    <script>
        const u = new URLSearchParams(window.location.search);
        const type = u.get('type') || 'personal';
        const basePrice = parseInt(u.get('price') || 0);
        let selected = [];

        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª
        const addons = [
            { id: 'driver', title: 'Ø³Ø§Ø¦Ù‚ Ø®Ø§Øµ', price: 25000, emoji: 'ğŸ‘”', mood: 'Ø®Ø¯Ù…Ø© Ø±Ø³Ù…ÙŠØ©' },
            { id: 'baby', title: 'ÙƒØ±Ø³ÙŠ Ø£Ø·ÙØ§Ù„', price: 10000, emoji: 'ğŸ‘¶', mood: 'Ø±Ø­Ù„Ø© Ø¹Ø§Ø¦Ù„ÙŠØ©' },
            { id: 'home', title: 'ØªÙˆØµÙŠÙ„ Ù„Ù„Ù…Ù†Ø²Ù„', price: 15000, emoji: 'ğŸ ', mood: 'Ø®Ø¯Ù…Ø© Ù…Ø±ÙŠØ­Ø©' }
        ];

        if(type === 'wedding') {
            addons.push({ id: 'wedding', title: 'ØªØ²ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆÙƒØ¨', price: 50000, emoji: 'ğŸŒ¸', mood: 'Ù„ÙŠÙ„Ø© Ø§Ù„Ø¹Ù…Ø±' });
        }

        function render() {
            const container = document.getElementById('addonsList');
            container.innerHTML = addons.map(item => `
                <div onclick="toggle('${item.id}', ${item.price}, '${item.emoji}', '${item.mood}', this)" class="smart-card p-5 flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="icon-circle">${item.emoji}</div>
                        <div>
                            <h4 class="font-black text-slate-800 text-sm">${item.title}</h4>
                            <span class="text-xs font-bold text-[#D4AF37]">+ ${item.price.toLocaleString()} Ø¯.Ø¹</span>
                        </div>
                    </div>
                    <div class="w-6 h-6 rounded-full border-2 border-slate-100 flex items-center justify-center transition-all check">
                        <i class="fas fa-check text-[10px] text-white opacity-0"></i>
                    </div>
                </div>
            `).join('');
            calculate();
        }

        function toggle(id, price, emoji, mood, el) {
            const idx = selected.findIndex(x => x.id === id);
            const check = el.querySelector('.check');
            const icon = el.querySelector('.fa-check');

            if(idx > -1) {
                selected.splice(idx, 1);
                el.classList.remove('selected');
                check.style.background = 'transparent';
                icon.style.opacity = '0';
            } else {
                selected.push({id, price, title: el.querySelector('h4').innerText, emoji});
                el.classList.add('selected');
                check.style.background = '#D4AF37';
                check.style.borderColor = '#D4AF37';
                icon.style.opacity = '1';
                
                // --- Ø°ÙƒØ§Ø¡ Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ù„Ø­Ø¸ÙŠ ---
                updateMood(emoji, mood, id);
            }
            calculate();
        }

        function updateMood(emoji, mood, id) {
            const body = document.body;
            const badge = document.getElementById('moodBadge');
            const title = document.getElementById('heroTitle');
            const heroEmoji = document.getElementById('heroEmoji');

            // ØªØºÙŠÙŠØ± Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
            heroEmoji.innerText = emoji;
            badge.innerText = mood;

            if(id === 'wedding') {
                body.style.backgroundColor = '#fff1f2'; // ÙˆØ±Ø¯ÙŠ
                badge.className = "mood-tag bg-pink-500 text-white inline-block mb-3";
                title.innerText = "Ø¹Ø±Ø³ Ø§Ù„Ø£Ø­Ù„Ø§Ù… ğŸŒ¸";
            } else if(id === 'driver') {
                body.style.backgroundColor = '#f0f9ff'; // Ø£Ø²Ø±Ù‚ Ø±Ø³Ù…ÙŠ
                badge.className = "mood-tag bg-blue-600 text-white inline-block mb-3";
                title.innerText = "ÙØ®Ø§Ù…Ø© Ø§Ù„Ø­ÙˆØª ğŸ‘”";
            } else if(id === 'baby') {
                body.style.backgroundColor = '#f0fdf4'; // Ø£Ø®Ø¶Ø± Ù‡Ø§Ø¯Ø¦ Ø¹Ø§Ø¦Ù„ÙŠ
                badge.className = "mood-tag bg-green-500 text-white inline-block mb-3";
                title.innerText = "Ø±Ø­Ù„Ø© Ø¹Ø§Ø¦Ù„ÙŠØ© Ø¢Ù…Ù†Ø© ğŸ‘¶";
            }
        }

        function calculate() {
            const sum = selected.reduce((s, a) => s + a.price, 0);
            document.getElementById('totalDisplay').innerText = (basePrice + sum).toLocaleString();
        }

        function confirmChoices() {
            const txt = selected.map(a => a.emoji + " " + a.title).join(' + ');
            u.set('addons', txt || 'Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ§Øª');
            u.set('final_price', document.getElementById('totalDisplay').innerText.replace(/,/g, ''));
            
            const target = (type === 'wedding') ? 'booking_wedding.html' : 'booking_personal.html';
            window.location.href = `${target}?${u.toString()}`;
        }

        window.onload = render;
    </script>
</body>
</html>
